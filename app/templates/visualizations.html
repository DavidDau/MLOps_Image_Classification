{% extends "base.html" %} {% block title %}Visualizations - Image
Classification{% endblock %} {% block content %}
<div class="row">
  <div class="col-12">
    <h1 class="mb-4"><i class="fas fa-chart-bar"></i> Data Visualizations</h1>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Training Dataset Distribution</h5>
      </div>
      <div class="card-body">
        <canvas id="datasetChart"></canvas>
        <div class="mt-3">
          <p><strong>Total Images:</strong> {{ stats.total_images }}</p>
          <p><strong>Number of Classes:</strong> {{ stats.classes|length }}</p>
        </div>
      </div>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Prediction Statistics</h5>
      </div>
      <div class="card-body">
        <canvas id="predictionChart"></canvas>
        {% if pred_stats and not pred_stats.get('error') %}
        <div class="mt-3">
          <p>
            <strong>Total Predictions:</strong> {{ pred_stats.total_predictions
            }}
          </p>
          <p>
            <strong>Success Rate:</strong>
            {{ "%.1f"|format((pred_stats.successful_predictions /
            pred_stats.total_predictions * 100) if pred_stats.total_predictions
            > 0 else 0) }}%
          </p>
          <p>
            <strong>Average Confidence:</strong>
            {{ "%.2f"|format(pred_stats.average_confidence * 100) }}%
          </p>
        </div>
        {% else %}
        <p class="text-muted">No prediction data available yet.</p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div class="card mb-4">
      <div class="card-header">
        <h5 class="mb-0">Dataset Insights</h5>
      </div>
      <div class="card-body">
        <h6>Class Distribution Analysis</h6>
        <p>
          The dataset contains images from {{ stats.classes|length }} different
          classes. Here's what the distribution tells us:
        </p>

        {% if stats.classes %}
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Class</th>
              <th>Number of Images</th>
              <th>Percentage</th>
              <th>Distribution</th>
            </tr>
          </thead>
          <tbody>
            {% for class_name, count in stats.classes.items() %}
            <tr>
              <td><strong>{{ class_name }}</strong></td>
              <td>{{ count }}</td>
              <td>
                {{ "%.1f"|format((count / stats.total_images * 100) if
                stats.total_images > 0 else 0) }}%
              </td>
              <td>
                <div class="progress">
                  <div
                    class="progress-bar"
                    role="progressbar"
                    style="width: {{ (count / stats.total_images * 100) if stats.total_images > 0 else 0 }}%"
                  ></div>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <div class="alert alert-info mt-3">
          <h6><i class="fas fa-info-circle"></i> Insights:</h6>
          <ul>
            <li>
              <strong>Balance:</strong>
              {% set max_count = stats.classes.values()|max %} {% set min_count
              = stats.classes.values()|min %} {% if max_count / min_count > 1.5
              %} The dataset appears imbalanced. Consider collecting more
              samples for underrepresented classes. {% else %} The dataset is
              well-balanced across classes. {% endif %}
            </li>
            <li>
              <strong>Size:</strong>
              {% if stats.total_images < 100 %} Dataset is small. Consider
              adding more samples for better model performance. {% elif
              stats.total_images < 1000 %} Dataset size is moderate. More data
              could improve accuracy. {% else %} Dataset size is good for
              training a robust model. {% endif %}
            </li>
          </ul>
        </div>
        {% else %}
        <p class="text-muted">
          No training data found. Please upload images to train the model.
        </p>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<script>
  // Dataset Distribution Chart
  {% if stats.classes %}
  const datasetCtx = document.getElementById('datasetChart').getContext('2d');
  new Chart(datasetCtx, {
      type: 'bar',
      data: {
          labels: {{ stats.classes.keys()|list|tojson }},
          datasets: [{
              label: 'Number of Images',
              data: {{ stats.classes.values()|list|tojson }},
              backgroundColor: [
                  'rgba(54, 162, 235, 0.7)',
                  'rgba(255, 99, 132, 0.7)',
                  'rgba(75, 192, 192, 0.7)',
                  'rgba(255, 206, 86, 0.7)',
                  'rgba(153, 102, 255, 0.7)'
              ],
              borderColor: [
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 99, 132, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(153, 102, 255, 1)'
              ],
              borderWidth: 2
          }]
      },
      options: {
          responsive: true,
          scales: {
              y: {
                  beginAtZero: true,
                  title: {
                      display: true,
                      text: 'Count'
                  }
              }
          },
          plugins: {
              legend: {
                  display: false
              },
              title: {
                  display: true,
                  text: 'Images per Class'
              }
          }
      }
  });
  {% endif %}

  // Prediction Statistics Chart
  {% if pred_stats and not pred_stats.get('error') and pred_stats.class_distribution %}
  const predCtx = document.getElementById('predictionChart').getContext('2d');
  new Chart(predCtx, {
      type: 'pie',
      data: {
          labels: {{ pred_stats.class_distribution.keys()|list|tojson }},
          datasets: [{
              data: {{ pred_stats.class_distribution.values()|list|tojson }},
              backgroundColor: [
                  'rgba(54, 162, 235, 0.7)',
                  'rgba(255, 99, 132, 0.7)',
                  'rgba(75, 192, 192, 0.7)',
                  'rgba(255, 206, 86, 0.7)',
                  'rgba(153, 102, 255, 0.7)'
              ],
              borderColor: [
                  'rgba(54, 162, 235, 1)',
                  'rgba(255, 99, 132, 1)',
                  'rgba(75, 192, 192, 1)',
                  'rgba(255, 206, 86, 1)',
                  'rgba(153, 102, 255, 1)'
              ],
              borderWidth: 2
          }]
      },
      options: {
          responsive: true,
          plugins: {
              legend: {
                  position: 'bottom'
              },
              title: {
                  display: true,
                  text: 'Predicted Class Distribution'
              }
          }
      }
  });
  {% endif %}
</script>
{% endblock %}
